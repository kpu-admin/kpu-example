
/**
 * 由 admin 提供技术支持
 * Powered by admin
 * 代码仓库
 * Github https://github.com/Lmx1220/kpu-web
 */
    
import{ao as se,r as w,H as ae,ap as H,d as P,A as U,D as Y,E as ie,C as re,f as m,o as g,w as c,y as h,j as t,aq as le,L as $,M as z,ar as ue,as as de,at as pe,au as ce,av as fe,B as k,z as ye,am as me,i as F,aw as ge,ax as ve,ay as he,az as Ce,aA as we,an as Pe,aB as Be,aC as be,aD as Oe,aE as L,aF as Me,N as G,aG as _e,O as b,a3 as Se,a2 as $e,aH as De,P as I,K as S,aI as Fe,aJ as ke}from"./bootstrap-DTzpk8a9.js";import{u as Ie}from"./useTypeahead-Dxoy5j1R.js";import{_ as Ee}from"./RovingFocusGroup-BuS0Erbr.js";import{u as Re}from"./useArrowNavigation-B5rxJs06.js";function Ke(){const s=w(!1);return ae(()=>{H("keydown",()=>{s.value=!0},{capture:!0,passive:!0}),H(["pointerdown","pointermove"],()=>{s.value=!1},{capture:!0,passive:!0})}),s}const Te=se(Ke),[E,Ae]=U(["MenuRoot","MenuSub"],"MenuContext"),[N,Le]=U("MenuRoot"),He=P({__name:"MenuRoot",props:{open:{type:Boolean,default:!1},dir:{},modal:{type:Boolean,default:!0}},emits:["update:open"],setup(s,{emit:u}){const a=s,r=u,{modal:y,dir:d}=Y(a),v=ie(d),p=re(a,"open",r),o=w(),f=Te();return Ae({open:p,onOpenChange:l=>{p.value=l},content:o,onContentChange:l=>{o.value=l}}),Le({onClose:()=>{p.value=!1},isUsingKeyboardRef:f,dir:v,modal:y}),(l,C)=>(g(),m(t(le),null,{default:c(()=>[h(l.$slots,"default")]),_:3}))}}),Ye=P({__name:"MenuAnchor",props:{reference:{},asChild:{type:Boolean},as:{}},setup(s){const u=s;return(a,r)=>(g(),m(t(ue),$(z(u)),{default:c(()=>[h(a.$slots,"default")]),_:3},16))}}),qe=P({__name:"MenuPortal",props:{to:{},disabled:{type:Boolean},defer:{type:Boolean},forceMount:{type:Boolean}},setup(s){const u=s;return(a,r)=>(g(),m(t(de),$(z(u)),{default:c(()=>[h(a.$slots,"default")]),_:3},16))}}),[q,Ue]=U("MenuContent"),J=P({__name:"MenuContentImpl",props:pe({loop:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},disableOutsideScroll:{type:Boolean},trapFocus:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{}},{...Me}),emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus","dismiss"],setup(s,{emit:u}){const a=s,r=u,y=E(),d=N(),{trapFocus:v,disableOutsidePointerEvents:p,loop:o}=Y(a);ce(),fe(p.value);const f=w(""),l=w(0),C=w(0),B=w(null),O=w("right"),R=w(0),K=w(null),V=w(),{forwardRef:Q,currentElement:_}=k(),{handleTypeaheadSearch:Z}=Ie();ye(_,e=>{y.onContentChange(e)}),me(()=>{window.clearTimeout(l.value)});function T(e){var i,M;return O.value===((i=B.value)==null?void 0:i.side)&&we(e,(M=B.value)==null?void 0:M.area)}async function x(e){var n;r("openAutoFocus",e),!e.defaultPrevented&&(e.preventDefault(),(n=_.value)==null||n.focus({preventScroll:!0}))}function ee(e){var j;if(e.defaultPrevented)return;const i=e.target.closest("[data-reka-menu-content]")===e.currentTarget,M=e.ctrlKey||e.altKey||e.metaKey,A=e.key.length===1,D=Re(e,Pe(),_.value,{loop:o.value,arrowKeyOptions:"vertical",dir:d==null?void 0:d.dir.value,focus:!0,attributeName:"[data-reka-collection-item]:not([data-disabled])"});if(D)return D==null?void 0:D.focus();if(e.code==="Space")return;const W=((j=V.value)==null?void 0:j.getItems())??[];if(i&&(e.key==="Tab"&&e.preventDefault(),!M&&A&&Z(e.key,W)),e.target!==_.value||!Be.includes(e.key))return;e.preventDefault();const X=[...W.map(ne=>ne.ref)];be.includes(e.key)&&X.reverse(),Oe(X)}function te(e){var n,i;(i=(n=e==null?void 0:e.currentTarget)==null?void 0:n.contains)!=null&&i.call(n,e.target)||(window.clearTimeout(l.value),f.value="")}function oe(e){var M;if(!L(e))return;const n=e.target,i=R.value!==e.clientX;if((M=e==null?void 0:e.currentTarget)!=null&&M.contains(n)&&i){const A=e.clientX>R.value?"right":"left";O.value=A,R.value=e.clientX}}return Ue({onItemEnter:e=>!!T(e),onItemLeave:e=>{var n;T(e)||((n=_.value)==null||n.focus(),K.value=null)},onTriggerLeave:e=>!!T(e),searchRef:f,pointerGraceTimerRef:C,onPointerGraceIntentChange:e=>{B.value=e}}),(e,n)=>(g(),m(t(Ce),{"as-child":"",trapped:t(v),onMountAutoFocus:x,onUnmountAutoFocus:n[7]||(n[7]=i=>r("closeAutoFocus",i))},{default:c(()=>[F(t(ge),{"as-child":"","disable-outside-pointer-events":t(p),onEscapeKeyDown:n[2]||(n[2]=i=>r("escapeKeyDown",i)),onPointerDownOutside:n[3]||(n[3]=i=>r("pointerDownOutside",i)),onFocusOutside:n[4]||(n[4]=i=>r("focusOutside",i)),onInteractOutside:n[5]||(n[5]=i=>r("interactOutside",i)),onDismiss:n[6]||(n[6]=i=>r("dismiss"))},{default:c(()=>[F(t(Ee),{ref_key:"rovingFocusGroupRef",ref:V,"current-tab-stop-id":K.value,"onUpdate:currentTabStopId":n[0]||(n[0]=i=>K.value=i),"as-child":"",orientation:"vertical",dir:t(d).dir.value,loop:t(o),onEntryFocus:n[1]||(n[1]=i=>{r("entryFocus",i),t(d).isUsingKeyboardRef.value||i.preventDefault()})},{default:c(()=>[F(t(ve),{ref:t(Q),role:"menu",as:e.as,"as-child":e.asChild,"aria-orientation":"vertical","data-reka-menu-content":"","data-state":t(he)(t(y).open.value),dir:t(d).dir.value,side:e.side,"side-offset":e.sideOffset,align:e.align,"align-offset":e.alignOffset,"avoid-collisions":e.avoidCollisions,"collision-boundary":e.collisionBoundary,"collision-padding":e.collisionPadding,"arrow-padding":e.arrowPadding,"prioritize-position":e.prioritizePosition,"position-strategy":e.positionStrategy,"update-position-strategy":e.updatePositionStrategy,sticky:e.sticky,"hide-when-detached":e.hideWhenDetached,reference:e.reference,onKeydown:ee,onBlur:te,onPointermove:oe},{default:c(()=>[h(e.$slots,"default")]),_:3},8,["as","as-child","data-state","dir","side","side-offset","align","align-offset","avoid-collisions","collision-boundary","collision-padding","arrow-padding","prioritize-position","position-strategy","update-position-strategy","sticky","hide-when-detached","reference"])]),_:3},8,["current-tab-stop-id","dir","loop"])]),_:3},8,["disable-outside-pointer-events"])]),_:3},8,["trapped"]))}}),ze=P({__name:"MenuRootContentModal",props:{loop:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(s,{emit:u}){const a=s,r=u,y=G(a,r),d=E(),{forwardRef:v,currentElement:p}=k();return _e(p),(o,f)=>(g(),m(J,b(t(y),{ref:t(v),"trap-focus":t(d).open.value,"disable-outside-pointer-events":t(d).open.value,"disable-outside-scroll":!0,onDismiss:f[0]||(f[0]=l=>t(d).onOpenChange(!1)),onFocusOutside:f[1]||(f[1]=Se(l=>r("focusOutside",l),["prevent"]))}),{default:c(()=>[h(o.$slots,"default")]),_:3},16,["trap-focus","disable-outside-pointer-events"]))}}),Ge=P({__name:"MenuRootContentNonModal",props:{loop:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(s,{emit:u}){const y=G(s,u),d=E();return(v,p)=>(g(),m(J,b(t(y),{"trap-focus":!1,"disable-outside-pointer-events":!1,"disable-outside-scroll":!1,onDismiss:p[0]||(p[0]=o=>t(d).onOpenChange(!1))}),{default:c(()=>[h(v.$slots,"default")]),_:3},16))}}),Je=P({__name:"MenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(s,{emit:u}){const y=G(s,u),d=E(),v=N();return(p,o)=>(g(),m(t($e),{present:p.forceMount||t(d).open.value},{default:c(()=>[t(v).modal.value?(g(),m(ze,$(b({key:0},{...p.$attrs,...t(y)})),{default:c(()=>[h(p.$slots,"default")]),_:3},16)):(g(),m(Ge,$(b({key:1},{...p.$attrs,...t(y)})),{default:c(()=>[h(p.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Ne=P({inheritAttrs:!1,__name:"MenuItemImpl",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{}},setup(s){const u=s,a=q(),{forwardRef:r}=k(),{CollectionItem:y}=De(),d=w(!1);async function v(o){if(!o.defaultPrevented&&L(o)){if(u.disabled)a.onItemLeave(o);else if(!a.onItemEnter(o)){const l=o.currentTarget;l==null||l.focus({preventScroll:!0})}}}async function p(o){await S(),!o.defaultPrevented&&L(o)&&a.onItemLeave(o)}return(o,f)=>(g(),m(t(y),{value:{textValue:o.textValue}},{default:c(()=>[F(t(I),b({ref:t(r),role:"menuitem",tabindex:"-1"},o.$attrs,{as:o.as,"as-child":o.asChild,"aria-disabled":o.disabled||void 0,"data-disabled":o.disabled?"":void 0,"data-highlighted":d.value?"":void 0,onPointermove:v,onPointerleave:p,onFocus:f[0]||(f[0]=async l=>{await S(),!(l.defaultPrevented||o.disabled)&&(d.value=!0)}),onBlur:f[1]||(f[1]=async l=>{await S(),!l.defaultPrevented&&(d.value=!1)})}),{default:c(()=>[h(o.$slots,"default")]),_:3},16,["as","as-child","aria-disabled","data-disabled","data-highlighted"])]),_:3},8,["value"]))}}),Qe=P({__name:"MenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{}},emits:["select"],setup(s,{emit:u}){const a=s,r=u,{forwardRef:y,currentElement:d}=k(),v=N(),p=q(),o=w(!1);async function f(){const l=d.value;if(!a.disabled&&l){const C=new CustomEvent(ke,{bubbles:!0,cancelable:!0});r("select",C),await S(),C.defaultPrevented?o.value=!1:v.onClose()}}return(l,C)=>(g(),m(Ne,b(a,{ref:t(y),onClick:f,onPointerdown:C[0]||(C[0]=()=>{o.value=!0}),onPointerup:C[1]||(C[1]=async B=>{var O;await S(),!B.defaultPrevented&&(o.value||(O=B.currentTarget)==null||O.click())}),onKeydown:C[2]||(C[2]=async B=>{const O=t(p).searchRef.value!=="";l.disabled||O&&B.key===" "||t(Fe).includes(B.key)&&(B.currentTarget.click(),B.preventDefault())})}),{default:c(()=>[h(l.$slots,"default")]),_:3},16))}}),Ze=P({__name:"MenuGroup",props:{asChild:{type:Boolean},as:{}},setup(s){const u=s;return(a,r)=>(g(),m(t(I),b({role:"group"},u),{default:c(()=>[h(a.$slots,"default")]),_:3},16))}}),xe=P({__name:"MenuSeparator",props:{asChild:{type:Boolean},as:{}},setup(s){const u=s;return(a,r)=>(g(),m(t(I),b(u,{role:"separator","aria-orientation":"horizontal"}),{default:c(()=>[h(a.$slots,"default")]),_:3},16))}}),et=P({__name:"MenuLabel",props:{asChild:{type:Boolean},as:{default:"div"}},setup(s){const u=s;return(a,r)=>(g(),m(t(I),$(z(u)),{default:c(()=>[h(a.$slots,"default")]),_:3},16))}});export{He as _,Ye as a,qe as b,Je as c,Qe as d,Ze as e,xe as f,et as g};
